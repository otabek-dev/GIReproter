stages:
  - build
  - migration
  - publish

build:
  tags:
  - dev
  stage: build
  script:
    - dotnet build

migration:
  tags:
  - dev
  stage: migration
  script:
    - dotnet ef database updates

publish_and_start:
  tags:
  - dev
  stage: publish
  script:
    - dotnet publish --configuration Release
    - sudo systemctl enable hisobot.service
    - sudo systemctl start hisobot.service
    - sudo systemctl restart hisobot.service